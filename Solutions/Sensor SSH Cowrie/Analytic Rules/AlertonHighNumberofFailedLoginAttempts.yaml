id: ccbfc8aa-d1fe-4f62-b192-67f6c4edc9a2
name: Alert on High Number of Failed Login Attempts
description: |
  'Detect brute-force or password-guessing attacks by monitoring a high volume of failed login attempts.'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: SensorSSHCowrie
    dataTypes:
      - newCowrie_CL
queryFrequency: 5m
queryPeriod: 5m
triggerOperator: gt
triggerThreshold: 0
tactics:
  - CredentialAccess
relevantTechniques:
  - T1110
query: |
  newCowrie_CL
  | extend EventID = tostring(parse_json(RawData).eventid)
  | extend SourceIP = tostring(parse_json(RawData).src_ip) 
  | where EventID == "cowrie.login.failed"
  | summarize FailedAttempts = count() by SourceIP
  | where FailedAttempts > 2
  | project SourceIP, FailedAttempts
  | order by FailedAttempts desc
entityMappings:
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: SourceIP
version: 1.0.1
kind: Scheduled