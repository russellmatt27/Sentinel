id: 4a566fa4-f901-44fd-9890-a476d163e86a
name: Detect Connection Events
description: |
  'Track connection events to detect unusual patterns in access or possible reconnaissance activity.'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: SensorSSHCowrie
    dataTypes:
      - newCowrie_CL
queryFrequency: 5m
queryPeriod: 5m
triggerOperator: gt
triggerThreshold: 0
tactics:
  - Discovery
relevantTechniques:
  - T0840
query: |
  newCowrie_CL
  | extend EventID = tostring(parse_json(RawData).eventid)
  | extend SourceIP = tostring(parse_json(RawData).src_ip)
  | where EventID == "cowrie.session.closed"
  | project SourceIP
entityMappings:
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: SourceIP
version: 1.0.1
kind: Scheduled