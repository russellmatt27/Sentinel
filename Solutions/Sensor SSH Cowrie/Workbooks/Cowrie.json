{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "union withsource=_TableName *\n| summarize Count=count() by _TableName\n| render barchart",
        "size": 1,
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "query - 2"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "newCowrie_CL\r\n| extend SourceIP = tostring(parse_json(RawData).src_ip)\r\n| summarize TotalSessions = count() by SourceIP\r\n| order by TotalSessions desc\r\n",
        "size": 0,
        "title": "Total Sessions by Source IP",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "piechart",
        "gridSettings": {
          "sortBy": [
            {
              "itemKey": "SourceIP",
              "sortOrder": 1
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "SourceIP",
            "sortOrder": 1
          }
        ]
      },
      "name": "query - 2"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "newCowrie_CL\r\n| extend EventID = tostring(parse_json(RawData).eventid)\r\n| summarize EventCount = count() by EventID\r\n| order by EventCount desc\r\n",
        "size": 0,
        "title": "Event Type Distribution",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "areachart"
      },
      "name": "query - 3"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "newCowrie_CL\r\n| extend Timestamp = todatetime(parse_json(RawData).timestamp)\r\n| summarize TotalSessions = count() by bin(Timestamp, 1h)\r\n| order by Timestamp\r\n",
        "size": 0,
        "title": "Session Trends Over Time",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "table"
      },
      "name": "query - 4"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "newCowrie_CL\r\n| extend EventID = tostring(parse_json(RawData).eventid), Timestamp = todatetime(parse_json(RawData).timestamp)\r\n| where EventID == \"cowrie.login.success\"\r\n| summarize SuccessfulLogins = count() by bin(Timestamp, 1h)\r\n| order by Timestamp\r\n",
        "size": 0,
        "title": "Successful Login Attempts Over Time",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "barchart"
      },
      "name": "query - 5"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "newCowrie_CL\r\n| extend EventID = tostring(parse_json(RawData).eventid), SourceIP = tostring(parse_json(RawData).src_ip)\r\n| where EventID == \"cowrie.login.failed\"\r\n| summarize FailedLogins = count() by SourceIP\r\n| order by FailedLogins desc\r\n",
        "size": 0,
        "title": "Failed Login Attempts",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "query - 6"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "newCowrie_CL\r\n| extend Duration = todouble(parse_json(RawData).duration), SourceIP = tostring(parse_json(RawData).src_ip)\r\n| summarize AvgDuration = avg(Duration) by SourceIP\r\n| order by AvgDuration desc\r\n",
        "size": 0,
        "title": "Session Duration Analysis",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "categoricalbar"
      },
      "name": "query - 7"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let GeoLocationData = datatable(SourceIP: string, Country: string, Latitude: real, Longitude: real)\r\n[\r\n    \"115.99.242.123\", \"India\", 12.97623, 77.60329,\r\n    \"162.142.125.41\", \"USA\", 42.25986, -83.7199\r\n];\r\nnewCowrie_CL\r\n| extend SourceIP = tostring(parse_json(RawData).src_ip)\r\n| join kind=inner (GeoLocationData) on SourceIP\r\n| summarize LoginAttempts = count() by Country, Latitude, Longitude\r\n| order by LoginAttempts desc\r\n",
        "size": 0,
        "title": "Login Attempts by Country",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "visualization": "map",
        "mapSettings": {
          "locInfo": "LatLong",
          "locInfoColumn": "Country",
          "latitude": "Latitude",
          "longitude": "Longitude",
          "sizeSettings": "LoginAttempts",
          "sizeAggregation": "Sum",
          "labelSettings": "Country",
          "legendMetric": "LoginAttempts",
          "legendAggregation": "Sum",
          "itemColorSettings": {
            "nodeColorField": "LoginAttempts",
            "colorAggregation": "Sum",
            "type": "heatmap",
            "heatmapPalette": "greenRed"
          }
        }
      },
      "name": "query - 7"
    }
  ],
  "fallbackResourceIds": [],
  "fromTemplateId": "sentinel-Cowrie",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}